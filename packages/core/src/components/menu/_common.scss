// Copyright 2016 Palantir Technologies, Inc. All rights reserved.
// Licensed under the BSD-3 License as modified (the “License”); you may obtain a copy
// of the license at https://github.com/palantir/blueprint/blob/master/LICENSE
// and https://github.com/palantir/blueprint/blob/master/PATENTS

$half-grid-size: $pt-grid-size / 2 !default;

$menu-item-border-radius: $pt-border-radius - 1 !default;

$menu-min-width: $pt-grid-size * 18 !default;
$menu-item-padding: ($pt-button-height - $pt-icon-size-standard) / 2 !default;
$menu-item-padding-large: ($pt-button-height-large - $pt-icon-size-large) / 2 !default;

$menu-background-color: $white !default;
$dark-menu-background-color: $dark-gray4 !default;

$menu-item-color-hover: $minimal-button-background-color-hover;
$menu-item-color-active: $minimal-button-background-color-active;
$dark-menu-item-color-hover: $dark-minimal-button-background-color-hover;
$dark-menu-item-color-active: $dark-minimal-button-background-color-active;

// customize modifier classes with params.
// setting modifier to "" will generally apply it as default styles due to & selectors
@mixin menu-item(
  $active-selector: ".pt-active",
  $disabled-selector: ".pt-disabled",
  $active-pseudoselector: ":active",
  $hover-pseudoselector: ":hover"
) {
  @include overflow-ellipsis();

  display: block;
  border-radius: $menu-item-border-radius;
  padding: $menu-item-padding;
  line-height: $pt-icon-size-standard;
  color: inherit;
  user-select: none;

  &#{$active-selector},
  &#{$active-selector}#{$hover-pseudoselector} {
    background: $pt-intent-primary;
    cursor: pointer;
    color: $white;
  }

  &#{$disabled-selector},
  &#{$disabled-selector}#{$hover-pseudoselector} {
    // override global a:focus styles
    outline: none;
    background: inherit;
    cursor: not-allowed;
    color: $pt-text-color-disabled;
  }

  &:not(#{$active-selector}):not(#{$disabled-selector}) {
    &#{$hover-pseudoselector} {
      background-color: $menu-item-color-hover;
      cursor: pointer;
      text-decoration: none;
      color: inherit;
    }

    &#{$active-pseudoselector} {
      background: $menu-item-color-active;
    }
  }

  .pt-dark & {
    @include dark-menu-item(
      $active-selector: ".pt-active",
      $disabled-selector: ".pt-disabled",
      $active-pseudoselector: ":active",
      $hover-pseudoselector: ":hover"
    );
  }
}

@mixin dark-menu-item(
  $active-selector: ".pt-active",
  $disabled-selector: ".pt-disabled",
  $active-pseudoselector: ":active",
  $hover-pseudoselector: ":hover"
) {
  color: inherit;

  &#{$disabled-selector} {
    color: $pt-dark-text-color-disabled;
  }

  &:not(#{$active-selector}):not(#{$disabled-selector}) {
    &#{$hover-pseudoselector} {
      background: $dark-menu-item-color-hover;
      color: inherit;
    }

    &#{$active-pseudoselector} {
      background: $dark-menu-item-color-active;
    }
  }
}

@mixin menu-item-large() {
  padding: $menu-item-padding-large $menu-item-padding;
  line-height: $pt-icon-size-large;
  font-size: $pt-font-size-large;
}

@mixin menu-divider() {
  display: block;
  margin: $half-grid-size;
  border-top: 1px solid $pt-divider-black;

  .pt-dark & {
    border-top-color: $pt-dark-divider-white;
  }
}

@mixin menu-header($heading-selector: null) {
  @include menu-divider();

  cursor: default;
  padding-left: $menu-item-padding - $half-grid-size;

  @if $heading-selector != null {
    &:first-of-type {
      border-top: none;
    }

    #{$heading-selector} {
      @include menu-heading();
    }

    &:first-of-type #{$heading-selector} {
      padding-top: 0;
    }
  }
}

@mixin menu-heading() {
  @include header-typography();
  @include overflow-ellipsis();

  margin: 0;
  padding: $pt-grid-size $menu-item-padding 0 1px;
  // a little extra space to avoid clipping descenders (because overflow hidden)
  line-height: $pt-icon-size-standard + 1px;
}

@mixin menu-header-large($heading-selector) {
  #{$heading-selector} {
    padding-top: $pt-grid-size * 1.5;
    padding-bottom: $pt-grid-size / 2;
    font-size: $pt-grid-size * 1.8;
  }

  &:first-of-type #{$heading-selector} {
    padding-top: 0;
  }
}
